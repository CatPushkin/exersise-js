{"mappings":"AAWA,MAAMA,EAAgBC,SAASC,cAAc,QACvCC,EAAWF,SAASC,cAAc,UAClCE,EAAaH,SAASC,cAAc,UAE1C,IAAIG,GAAiB,EAErB,IAAIC,EAAO,EACPC,EAAYC,KAAKC,KAAK,GAoD1BT,EAAcU,iBAAiB,SAvC/B,WAFSC,MADK,8DAA2CL,KACrCM,MAAKC,GAAKA,EAAEC,SAGjBF,MAAKG,IAChBZ,EAASa,mBAAmB,YAAyBD,EAapDE,KAAI,EAACC,GAAEA,EAAEC,MAAEA,EAAKC,KAAEA,EAAIC,OAAEA,KAChB,gDAC4BF,EAAMG,MAAM,EAAG,gDACnBJ,+CACEG,+CACAD,6BAGlCG,KAAK,IArBqD,IAEzDjB,IAASC,GACXP,EAAcwB,MAAMC,QAAU,OAuBlC,WACE,GAAIpB,EACF,OAEFA,GAAiB,EACjBD,EAAWsB,UAAUC,IAAI,cACzBC,YAAW,KACTxB,EAAWsB,UAAUG,OAAO,cAC5BxB,GAAiB,CAAK,GACrB,I,CA/BDyB,KAEA9B,EAAc+B,YAAc,YAC5BzB,GAAQ,E","sources":["src/js/load-more.js"],"sourcesContent":["/* 1. Load more button\nВикористовуй html з файлу load_more.html.\nВикористовуй {JSON} Placeholder API\nСтвори змінну limit і задай їй значення 20, це буде кількість постів на сторінку.\n\nЩоб динамічно змінювати номер групи на кожний наступний запит, достатньо оголосити глобальну змінну, назвемо її page і встановимо початкове значення 1 - перша група елементів. Після кожного успішного запиту, в колбек методу then() будемо збільшувати значення page на одиницю. Складаючи параметри запиту, використовуємо її значення.\n\nПісля завантаження першої групи елементів, текст на кнопці зміниться, а сама кнопка опуститься під список постів. Коли користувач прокрутить сторінку і знову клікне по ній - виконається запит за другою групою елементів, яка додасться до вже існуючої розмітки списку постів. У разі відсутності постів для завантаження під час кліку на кнопку «Fetch posts» - показуємо повідомлення\n\nПотрібно додали перевірку кінця колекції на фронтенді, тому що JSONPlaceholder API не реалізує цей функціонал на бекенді. У нашому випадку достатньо розділити загальну кількість елементів в колекції на кількість елементів в одній групі. Це схоже на випадок, коли бекенд повертає не кількість доступних сторінок, а загальну кількість елементів в колекції.\n */\nconst fetchPostsBtn = document.querySelector('.btn');\nconst userList = document.querySelector('.posts');\nconst alertPopup = document.querySelector('.alert');\n\nlet isAlertVisible = false;\nconst limit = 20;\nlet page = 1;\nlet totalPage = Math.ceil(100 / limit);\n\nconst BASE_URL = 'https://jsonplaceholder.typicode.com';\nconst END_POINT = '/posts';\n// const params = new URLSearchParams({\n//   limit,\n//   page,\n// });\n\nfunction fetchPosts() {\n  const url = `${BASE_URL}${END_POINT}?_limit=20&_page=${page}`;\n  return fetch(url).then(r => r.json());\n}\nfunction handleClick() {\n  fetchPosts().then(data => {\n    userList.insertAdjacentHTML('beforeend', renderPosts(data));\n  });\n  if (page === totalPage) {\n    fetchPostsBtn.style.display = 'none';\n    toggleAlertPopup();\n  } else {\n    fetchPostsBtn.textContent = 'Load more';\n    page += 1;\n  }\n}\n\nfunction renderPosts(posts) {\n  const markup = posts\n    .map(({ id, title, body, userId }) => {\n      return `<li>\n                <h2 class=\"post-title\">${title.slice(0, 30)}</h2>\n                <p><b>Post id</b>: ${id}</p>\n                <p><b>Author id</b>: ${userId}</p>\n                <p class=\"post-body\">${body}</p>\n            </li>`;\n    })\n    .join('');\n\n  return markup;\n}\n\nfunction toggleAlertPopup() {\n  if (isAlertVisible) {\n    return;\n  }\n  isAlertVisible = true;\n  alertPopup.classList.add('is-visible');\n  setTimeout(() => {\n    alertPopup.classList.remove('is-visible');\n    isAlertVisible = false;\n  }, 3000);\n}\nfetchPostsBtn.addEventListener('click', handleClick);\n"],"names":["$e13b538bfdccfbd0$var$fetchPostsBtn","document","querySelector","$e13b538bfdccfbd0$var$userList","$e13b538bfdccfbd0$var$alertPopup","$e13b538bfdccfbd0$var$isAlertVisible","$e13b538bfdccfbd0$var$page","$e13b538bfdccfbd0$var$totalPage","Math","ceil","addEventListener","fetch","then","r","json","data","insertAdjacentHTML","map","id","title","body","userId","slice","join","style","display","classList","add","setTimeout","remove","$e13b538bfdccfbd0$var$toggleAlertPopup","textContent"],"version":3,"file":"load_more.df73b629.js.map"}